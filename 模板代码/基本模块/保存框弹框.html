      /*样式*/

	  /*保存弹框的样式*/
		.divborder {
			border: 1px dashed #000000;
		}
		
		#edit_layer {
			position: absolute;
			width: 100%;
			height: 100%;
			z-index: 10000;
			background-color: #000;
			opacity: 0.5;
		}
		
		#edit_dialog {
			z-index: 10001;
			position: fixed;
			width: 100%;
			height: 150px;
			text-align: center;
			background-color: ghostwhite;
			padding-top: 5%;
			border-bottom: 0.001rem solid gray;
		}
		
		#edit_dialog textarea {
			resize: none;
			width: 95%;
			height: 80%;
			margin: 0 auto;
			border-radius: 0.10rem;
		}
		
		#edit_dialog ul {
			width: 95%;
			text-align: center;
			margin: 0 auto;
		}
		
		#edit_dialog ul:after {
			clear: both;
			display: inline-block;
			content: '';
			width: 0;
			height: 0;
			visibility: hidden;
		}
		
		#edit_dialog ul li {
			margin: 0 auto;
			display: inline-block;
			margin: 0 auto;
			float: left;
			font-size: 0.30rem;
		}
		
		#edit_dialog ul li:nth-child(1) {
			color: dodgerblue;
		}
		
		#edit_dialog ul li:nth-child(2) {
			margin: 0% 39%;
		}
		
		#edit_dialog ul li:nth-child(3) {
			color: dodgerblue;
		}
		
		.imgIndex {
			display: none;
		}
		
		#dialogTop {
			position: absolute;
			z-index: 10000000;
			top: -10%;
		}
		
		#diaContTil {
			width: 90%;
			margin: 0 auto;
			padding-top: 2%;
			margin-bottom: 2%;
		}
		
		#diaContTil p {
			font-size: 0.3rem;
			color: #2E2D3C;
		}
		
		#diaContTil input {
			border: none;
			background-color: white;
		}
		
		#diaContMid {
			width: 100%;
			position: relative;
		}
		
		#diaContMid:after {
			clear: both;
			content: '';
			height: 0;
			width: 0;
			visibility: hidden;
			display: block;
		}
		
		#diaContMid ul li {
			float: left;
			margin-top: 5%;
			margin-left: 5%;
			margin-bottom: 5%;
			position: relative;
		}
		
		#diaContMid ul li:nth-child(1) {
			width: 30%;
			height: 120px;
		}
		
		#diaContMid ul li:nth-child(1) img {
			width: 100%;
			height: 100%;
		}
		
		#diaContMid ul li:nth-child(1) p {
			position: absolute;
			margin-top: -20%;
			text-align: center;
			width: 100%;
			color: white;
			background-color: #000000;
			padding-top: 1rem 0rem;
		}
		
		#diaContMid ul li:nth-child(2) textarea {
			width: 110%;
			height: 120px;
			resize: none;
			border-radius: 0.2rem;
		}
		
		#diaContMid ul li:nth-child(2) p {
			position: absolute;
			margin-top: -18%;
			right: 0rem;
		}
		
		#diaFotter {
			width: 100%;
			text-align: center;
		}
		
		#diaFotter p {
			color: goldenrod;
		}
		
		.fen_title {
			width: 100%;
			margin-bottom: 0.4rem;
			overflow: hidden;
			position: relative
		}
		.fen_title:after{
			clear: both;
			content: '';
			width: 0;
			height: 0;
			visibility: hidden;
			display: block;
		}
		
		.fen_title label {
			color: #333;
			font-size: 0.26rem;
		}
		
		.fen_title input {
			border: none;
			line-height: 0.4rem;
			padding: 0 0.1rem;
			padding-right: 0.2rem;
		}
		
		.fen_title textarea {
			border: none;
			resize: none;
			height: 2.4rem;
			background-color: #ededed;
			padding: 0.1rem;
			box-sizing: border-box;
			width: 100%
		}
		
		.fen_title span {
			display: inline-block;
			position: absolute;
			right: 0.4rem;
			top: 2rem;
			font-size: 0.2rem;
			color: #F00
		}
		
		.fen_title span input {
			font-size: 0.2rem;
			width: 0.3rem;
			background: none;
			padding: 0;
			color: #F00;
			text-align: right
		}
		
		.layer_btn {
			text-align: center;
			border-top: 1px solid #ccc;
			padding: 0.1rem 1rem;
		}
		
		.layer_btn a {
			display: inline-block;
			width: 1.4rem;
			text-align: center;
			border-radius: 0.1rem;
			line-height: 0.5rem;
			font-size: 0.3rem;
			color: #dbb669;
		}
		
		.fen_title1 {
			padding: 0.1rem 0.2rem;
			border-bottom: 1px solid #ccc
		}
		
		.fen_title2 {
			float: left;
			width: 55%;
			margin-right: 5%
		}
		
		.fen_title2 label {
			width: 100%;
			display: block;
		}
		
		.layui-layer-setwin .layui-layer-close2 {
			right: -20px!important;
		}
		
		.fen_title .left_box {
			width: 30%;
			float: left;
			text-align: center;
			height: 2.4rem;
			overflow: hidden;
			margin-left: 5%;
			margin-right: 5%;
			position: relative
		}
		
		.fen_title .left_box img {
			width: 100%;
			height: 100%
		}
		
		.fen_title .left_box i {
			width: 100%;
			position: absolute;
			bottom: 0;
			left: 0;
			height: 0.5rem;
			line-height: 0.5rem;
			font-size: 0.26rem;
			text-align: center;
			color: #fff;
			background-color: #000;
			opacity: 0.7;
			font-style: normal
		}
		
		.tishi {
			width: 100%;
			position: absolute;
			top: -44%;
			left: 50%;
			margin-left: -50%;
			color: #fff;
			font-size: 0.4rem;
			background: url(http://qhb.lelego.net.cn/upload/tpl_file/public/module_icon_arrow.png) center bottom no-repeat;
			background-size: 5% auto;
			padding-bottom: 0.8rem
		}
		#dia_pageNum span:nth-child(1){
			margin-right: 0.4rem;
		}
		#dia_pageNum span:nth-child(2){
			margin-right: 0.3rem;
		}
		
		.layui-form-radio span {
			color: #000;
		}
		
		.layui-form-radio {
			display: block;
			width: 60%;
			margin: 0 auto;
			margin-bottom: 0.1rem;
		}
		
		.layui-input-block {
			margin-left: 0
		}
		
		.layui-textarea {
			width: 60%;
			margin: 0 auto;
			margin-bottom: 0.2rem;
			resize: none;
			display: none
		}
		.winning-class{ border-radius:0.2rem!important; background-color:#fff!important; width:96%}
		.winning-class .layui-layer-content{ padding:0!important}
		.layui-layer-msg .layui-layer-padding{ color:#f00;}
		.layui-layer-msg{top:80%!important}
		.winning-class .layui-layer-content{ overflow:inherit!important}
		
		/*保存弹框的样式*/





		
		/*js*/
		
		//初始化弹框
		/*layui.use('layer', function() { //独立版的layer无需执行这一句
			var $ = layui.jquery,
				layer = layui.layer; //独立版的layer无需执行这一句
		});*/

		layui.use(['form', 'layedit', 'laydate'], function(){
		  var form = layui.form
		  ,layer = layui.layer
		  ,layedit = layui.layedit
		  ,laydate = layui.laydate;
		  form.render();
		});


		//保存弹框的函数
		function saveDialog() {
			var title = '<{$user_template_title}>' || '元旦节报名';
			var miaoshu = '<{$user_template_digest}>' || '小蜜蜂琴行祝大家元旦节快乐';
			var img_input = '<{$template_image}>';
			var tamp = "<form>";
			tplTitle = '<{$user_template_title}>' || '元旦节报名';;
			tplDigest = '<{$user_template_digest}>' || '小蜜蜂琴行祝大家元旦节快乐';
			tamp += "<div class='fen_title fen_title1' style='border-bottom:1px soild #ccc'>";
			tamp += "<label>分享标题：</label><input type='text' id='fen_t'  placeholder='请输入标题' value='" + title + "' />";
			tamp += "</div>";
			tamp += "<div class='fen_title'>";
			tamp += "<div class='left_box' onclick='fen_img.click()' ><i>更换封面</i>";
			tamp += "<input type='file' accept='image/*' id='fen_img' onClick=\"clipPhoto('#fen_img','#imgload','120','120','-1')\" value='请点击上传图片' style='display:none;' />";
			tamp += "<img src='" + img_input + "' class='my_img' id='imgload'/>";
			tamp += "</div>";
			tamp += "<div class='fen_title2'><textarea name='message' maxlength='60'  id='fen_miaoshu'>" + miaoshu + "</textarea><p id='dia_pageNum'><span>1</span><span>/</span><span>60</span></p></div>";
			tamp += "</div>";
			tamp += "<div class='layer_btn'>";
			tamp += "<a id='shareSave'>保存</a>";
			tamp += "</div>";
			tamp += "<div class='tishi'>这是分享后朋友们看见的标题、摘要和封面，请记得修改哦!</div>";
			tamp += "</form>";
			layer.open({
				skin:'winning-class',
				title: false,
				content: tamp,
				btn: false,
				success: function(layero) {
					$('' + layero.selector + '').find("div").css({ 'overflow': 'inherit' });
					$('.layui-layer-shade').css('opacity', '0.7');
					//textare的原本长度
					$('#dia_pageNum').find('span:nth-child(1)').html(miaoshu.length);
					//给分享图片赋予默认值
					shareBgi = '<{$template_image}>';
				}
			});

			$('#fen_t').change(function() {
				tplTitle = $(this).val()
			});

			$('#fen_miaoshu').change(function() {
				tplDigest = $(this).val()
			});

			$('#fen_miaoshu').bind('input propertychange', function() {
				$('#dia_pageNum').find('span:nth-child(1)').html($(this).val().length);
			});

			
			//点击分享保存
			$('.layer_btn').click(function() {

				if($('#fen_t').val() == "" || $('#fen_miaoshu') == "") {
					alert("请填写分享标题或内容~");
					return false;
				} else {

					//获取要提交的文字
					for(var i = 1; i <= 24; i++) {
						if(i == 7 || i == 8) {
							if($('#swi3_cont_1').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else if(i == 9 || i == 10) {
							if($('#swi3_cont_2').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else if(i == 11 || i == 12) {
							if($('#swi3_cont_3').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else if(i == 14 || i == 15) {
							if($('#swi4_cont_1').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else if(i == 16 || i == 17) {
							if($('#swi4_cont_2').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else if(i == 18 || i == 19) {
							if($('#swi4_cont_3').hasClass('divHide') == true) {
								textJson['ed' + i] = 'hide';
							} else {
								textJson['ed' + i] = $('#ed' + i).html();
							}
						} else {
							textJson['ed' + i] = $('#ed' + i).html();
						}
					}

					//获取修改图片
					for(var i = 1; i <= 7; i++) {
						if(i == 2) {
							if($('#swi3_cont_1').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}else if( i == 3){
							if($('#swi3_cont_2').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}else if( i == 4){
							if($('#swi3_cont_3').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}else if( i == 5){
							if($('#swi4_cont_1').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}else if( i == 6){
							if($('#swi4_cont_2').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}else if( i == 7){
							if($('#swi4_cont_3').hasClass('divHide') == true) {
								imgArr[i - 1] = 'hide';
							} else {
								imgArr[i - 1] = $('#edimg' + i).attr('src');
							}
						}
						else {
							imgArr[i - 1] = $('#edimg' + i).attr('src');
						}
					}

					
					

					//保存之前先将base64的图片转成url
					$.each(imgArr,function(i){
						//判断是否存在base64的图片
						if(imgArr[i].indexOf('base64') != -1){
							$.ajax({
								type: "post",
								url: "http://<{$sys_domain}>/modules/wap_user_tpl_edit/post.php?class=update_image",
								type: "POST",
								dataType: "json",
								async:false,
								data: {
									userid: '<{$template_user_id}>',
									image_base64: imgArr[i],
								},
								success: function(data) {
									imgArr[i] = data.data.url;
								}
							});
						}
					});


					//保存之前先将base64的分享图片转成url
					$.each(tal_shareBgi,function(i){
						//判断是否存在base64的图片
						if(tal_shareBgi[0].indexOf('base64') != -1){
							$.ajax({
								type: "post",
								url: "http://<{$sys_domain}>/modules/wap_user_tpl_edit/post.php?class=update_image",
								type: "POST",
								dataType: "json",
								async:false,
								data: {
									userid: '<{$template_user_id}>',
									image_base64: tal_shareBgi[0],
								},
								success: function(data) {
									tal_shareBgi[0] = data.data.url;
								}
							});
						}
					});


				
					

					//将自定义图片存进textJson
					textJson['imgArr'] = imgArr;

					//将背景音乐存进textJson
					textJson['bgdMusic'] = bgdMusic;

					//坐标添加进textJson里
					textJson['positionX'] = positionX;
					textJson['positionY'] = positionY;

					console.log(textJson);


					//保存文字
					$.ajax({
						type: "post",
						url: "http://<{$sys_domain}>/modules/wap_user_tpl_edit/post.php?class=update",
						dataType: "json",
						data: {
							json: JSON.stringify(textJson),
							id: '<{$user_template_id}>',
							userid: '<{$template_user_id}>',
							tpl_project_name: '元旦节3',
							tpl_amount: 0,
							tplid: '<{$template_id}>',
							tpl_people: 10000,
							tpl_title: tplTitle,
							tpl_digest: tplDigest,
							tpl_img: tal_shareBgi[0],
							tpl_amount: ""
						},
						success: function(data) {
							debugger;
							//如果等于‘0’就是新增的，跳转页面时加上返回的uniqid
							if(data.status = true && '<{$user_template_id}>' == 0) {
								location.href = '<{$user_template_url}>' + data.data.uniqid;
							} else if(data.status = true){
								location.href = '<{$user_template_url}>';
							}else{
								alert(data.data.msg);
							}

						}
					});

				}

		});

	}